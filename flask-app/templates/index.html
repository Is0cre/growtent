{% extends "base.html" %}
{% block content %}

<section>
  <h2>Relay States</h2>
  {% if states.states %}
    <p><small>From log: {{ states.timestamp or "n/a" }}</small></p>
    <ul>
      {% for k,v in states.states.items() %}
        <li><strong>{{ k }}</strong>: <span class="{{ 'on' if v=='ON' else 'off' }}">{{ v }}</span></li>
      {% endfor %}
    </ul>
  {% else %}
    <p>No states found. (Looking for {{ states.log or '' }})</p>
  {% endif %}
</section>

<section>
  <h2>Camera</h2>
  <form method="post" action="{{ url_for('toggle_timelapse') }}">
    <button type="submit">{{ 'Stop timelapse' if timelapse_on else 'Start timelapse' }}</button>
  </form>
  <p><a href="{{ url_for('snapshot') }}" target="_blank">Take Snapshot</a></p>

  {% if latest_image %}
  <h3>Latest</h3>
  <img style="max-width:100%;height:auto"
       src="{{ url_for('image', day=latest_dir, filename=latest_image) }}" alt="latest">
  {% else %}
  <p>No images yet.</p>
  {% endif %}
</section>

<section>
  <h2>Timelapse Days</h2>
  <ul>
    {% for d in days %}
      <li>{{ d }}</li>
    {% endfor %}
  </ul>
</section>

{% endblock %}
